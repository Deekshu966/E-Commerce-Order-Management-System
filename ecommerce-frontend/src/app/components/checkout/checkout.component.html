<div class="checkout-container">
  <div class="container">
    <div class="page-header">
      <h1>Checkout</h1>
      <div class="checkout-steps">
        <span class="step active">1. Shipping</span>
        <span class="step">2. Payment</span>
        <span class="step">3. Confirmation</span>
      </div>
    </div>

    <div class="checkout-content">
      <!-- Shipping Form -->
      <div class="checkout-form">
        <div class="form-section">
          <h2>Shipping Information</h2>
          
          <div class="alert alert-danger" *ngIf="errorMessage">
            {{ errorMessage }}
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label">First Name *</label>
              <input 
                type="text" 
                class="form-control"
                [class.is-invalid]="touched['firstName'] && fieldErrors['firstName']"
                [(ngModel)]="shippingAddress.firstName"
                (blur)="onFieldBlur('firstName')"
                placeholder="First name"
              />
              <div class="invalid-feedback" *ngIf="touched['firstName'] && fieldErrors['firstName']">
                {{ fieldErrors['firstName'] }}
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Last Name *</label>
              <input 
                type="text" 
                class="form-control"
                [class.is-invalid]="touched['lastName'] && fieldErrors['lastName']"
                [(ngModel)]="shippingAddress.lastName"
                (blur)="onFieldBlur('lastName')"
                placeholder="Last name"
              />
              <div class="invalid-feedback" *ngIf="touched['lastName'] && fieldErrors['lastName']">
                {{ fieldErrors['lastName'] }}
              </div>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Email *</label>
            <input 
              type="email" 
              class="form-control"
              [class.is-invalid]="touched['email'] && fieldErrors['email']"
              [(ngModel)]="shippingAddress.email"
              (blur)="onFieldBlur('email')"
              placeholder="Email address"
            />
            <div class="invalid-feedback" *ngIf="touched['email'] && fieldErrors['email']">
              {{ fieldErrors['email'] }}
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Street Address *</label>
            <input 
              type="text" 
              class="form-control"
              [class.is-invalid]="touched['address'] && fieldErrors['address']"
              [(ngModel)]="shippingAddress.address"
              (blur)="onFieldBlur('address')"
              placeholder="Street address"
            />
            <div class="invalid-feedback" *ngIf="touched['address'] && fieldErrors['address']">
              {{ fieldErrors['address'] }}
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label">City *</label>
              <input 
                type="text" 
                class="form-control"
                [class.is-invalid]="touched['city'] && fieldErrors['city']"
                [(ngModel)]="shippingAddress.city"
                (blur)="onFieldBlur('city')"
                placeholder="City"
              />
              <div class="invalid-feedback" *ngIf="touched['city'] && fieldErrors['city']">
                {{ fieldErrors['city'] }}
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">State *</label>
              <input 
                type="text" 
                class="form-control"
                [class.is-invalid]="touched['state'] && fieldErrors['state']"
                [(ngModel)]="shippingAddress.state"
                (blur)="onFieldBlur('state')"
                placeholder="State"
              />
              <div class="invalid-feedback" *ngIf="touched['state'] && fieldErrors['state']">
                {{ fieldErrors['state'] }}
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">ZIP Code *</label>
              <input 
                type="text" 
                class="form-control"
                [class.is-invalid]="touched['zipCode'] && fieldErrors['zipCode']"
                [(ngModel)]="shippingAddress.zipCode"
                (blur)="onFieldBlur('zipCode')"
                placeholder="ZIP Code"
              />
              <div class="invalid-feedback" *ngIf="touched['zipCode'] && fieldErrors['zipCode']">
                {{ fieldErrors['zipCode'] }}
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Order Summary -->
      <div class="order-summary">
        <div class="summary-card">
          <h3>Order Summary</h3>
          
          <div class="order-items">
            <div class="order-item" *ngFor="let item of cartItems">
              <img [src]="item.product.image" [alt]="item.product.name" />
              <div class="item-details">
                <span class="item-name">{{ item.product.name }}</span>
                <span class="item-qty">Qty: {{ item.quantity }}</span>
              </div>
              <span class="item-price">₹{{ (item.product.price * item.quantity).toFixed(2) }}</span>
            </div>
          </div>

          <div class="summary-divider"></div>

          <div class="summary-row">
            <span>Subtotal</span>
            <span>₹{{ getSubtotal().toFixed(2) }}</span>
          </div>
          
          <div class="summary-row">
            <span>Shipping</span>
            <span>Free</span>
          </div>
          
          <div class="summary-row">
            <span>Tax (8%)</span>
            <span>₹{{ getTax().toFixed(2) }}</span>
          </div>
          
          <div class="summary-divider"></div>
          
          <div class="summary-row total">
            <span>Total</span>
            <span>₹{{ getTotal().toFixed(2) }}</span>
          </div>

          <button 
            class="btn btn-primary btn-block"
            (click)="proceedToPayment()"
          >
            Continue to Payment
          </button>
          
          <a routerLink="/cart" class="back-link">
            ← Back to Cart
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
